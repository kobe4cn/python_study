# ============================================================
# RAG文档系统 - 环境变量配置示例
# ============================================================
# 复制此文件为 .env 并填入实际值
# 生产环境务必修改所有敏感信息


# ============================================================
# 应用基础配置
# ============================================================
APP_NAME=RAG Document System
APP_VERSION=1.0.0
ENVIRONMENT=development  # development | staging | production
DEBUG=false

# 服务器配置
HOST=0.0.0.0
PORT=8000
WORKERS=4
RELOAD=false

# TLS/HTTPS配置
USE_HTTPS=false
SSL_CERTFILE=
SSL_KEYFILE=


# ============================================================
# LLM配置
# ============================================================
# 支持的提供商: qwen | openai | anthropic | deepseek
LLM_PROVIDER=qwen
LLM_MODEL=qwen3-max
LLM_API_KEY=your-api-key-here
LLM_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1

# 模型参数
LLM_TEMPERATURE=0.5
LLM_MAX_TOKENS=4096
LLM_STREAM=true
LLM_TIMEOUT=60
LLM_MAX_RETRIES=3

# OpenAI配置示例(切换提供商时使用)
# LLM_PROVIDER=openai
# LLM_MODEL=gpt-4
# LLM_API_KEY=sk-xxx
# LLM_BASE_URL=https://api.openai.com/v1


# ============================================================
# 向量存储配置
# ============================================================
# 支持的类型: qdrant | pinecone | weaviate | chroma
VECTOR_STORE_TYPE=qdrant

# Qdrant配置
VECTOR_QDRANT_HOST=localhost
VECTOR_QDRANT_PORT=6333
VECTOR_QDRANT_COLLECTION=documents
VECTOR_QDRANT_API_KEY=

# 嵌入模型配置
VECTOR_EMBEDDING_MODEL=text-embedding-v4
VECTOR_EMBEDDING_DIMENSION=1536
VECTOR_EMBEDDING_BATCH_SIZE=100


# ============================================================
# 数据库配置
# ============================================================
# PostgreSQL (推荐生产环境)
DB_URL=postgresql://homework:your-password@localhost:5432/homework_db

# SQLite (开发环境)
# DB_URL=sqlite:///./data/app.db

# MySQL
# DB_URL=mysql+pymysql://user:password@localhost:3306/dbname

# 连接池配置
DB_ECHO=false
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600


# ============================================================
# 缓存配置
# ============================================================
CACHE_ENABLED=true
CACHE_BACKEND=redis  # redis | memory

# Redis配置
CACHE_REDIS_HOST=localhost
CACHE_REDIS_PORT=6379
CACHE_REDIS_DB=0
CACHE_REDIS_PASSWORD=

# 缓存策略
CACHE_TTL=300
CACHE_MAX_SIZE=1000


# ============================================================
# 安全配置
# ============================================================
# JWT配置 (生产环境必须修改!)
SECURITY_SECRET_KEY=your-secret-key-change-in-production-minimum-32-chars
SECURITY_ALGORITHM=HS256
SECURITY_ACCESS_TOKEN_EXPIRE_MINUTES=30
SECURITY_REFRESH_TOKEN_EXPIRE_DAYS=7

# API密钥认证
SECURITY_API_KEY_HEADER_NAME=X-API-Key
SECURITY_API_KEYS=

# CORS配置
SECURITY_CORS_ENABLED=true
SECURITY_CORS_ORIGINS=http://localhost:3000,http://localhost:5173


# ============================================================
# 文档处理配置
# ============================================================
# 文件上传
DOC_MAX_UPLOAD_SIZE=52428800  # 50MB in bytes
DOC_ALLOWED_EXTENSIONS=.pdf,.txt,.md,.doc,.docx,.html,.json
DOC_UPLOAD_DIR=./uploads

# 文档分块
DOC_CHUNK_SIZE=1000
DOC_CHUNK_OVERLAP=200

# 检索配置
DOC_TOP_K=5


# ============================================================
# 可观测性配置
# ============================================================
# 日志配置
OBSERVABILITY_LOG_LEVEL=INFO
OBSERVABILITY_LOG_FORMAT=json  # json | text
OBSERVABILITY_LOG_FILE=

# Prometheus指标
OBSERVABILITY_METRICS_ENABLED=true
OBSERVABILITY_METRICS_PATH=/metrics

# OpenTelemetry追踪
OBSERVABILITY_TRACING_ENABLED=false
OBSERVABILITY_OTEL_SERVICE_NAME=rag-system
OBSERVABILITY_OTEL_EXPORTER_ENDPOINT=


# ============================================================
# 速率限制配置
# ============================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT=100/minute


# ============================================================
# 工具服务配置
# ============================================================
# Tavily搜索API
TAVILY_API_KEY=your-tavily-api-key


# ============================================================
# 兼容性配置 (向后兼容旧环境变量)
# ============================================================
# 以下配置会自动映射到新的配置系统
OPENAI_API_KEY=${LLM_API_KEY}
OPENAI_BASE_URL=${LLM_BASE_URL}


# ============================================================
# 生产环境安全检查清单
# ============================================================
# ✅ 修改 SECURITY_SECRET_KEY 为强随机密钥
# ✅ 设置 DEBUG=false
# ✅ 启用 USE_HTTPS=true 并配置SSL证书
# ✅ 配置强密码的数据库连接
# ✅ 设置 CACHE_REDIS_PASSWORD
# ✅ 配置合适的 SECURITY_CORS_ORIGINS
# ✅ 定期轮换 LLM_API_KEY
# ✅ 启用日志记录 OBSERVABILITY_LOG_FILE
# ✅ 配置监控 OBSERVABILITY_METRICS_ENABLED=true
